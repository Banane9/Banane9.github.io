<html>
	<head>
		<title>Player Title Card Generator!</title>
		
		<meta charset="UTF-8" />
		
		<link rel="icon" href="../favicon.ico"/>
		<link rel="shortcut icon" href="../favicon.ico"/>
		<link href="../favicon.ico"/>
		
		<style>
			@font-face {
				font-family: "Trajan Pro";
				font-weight: regular;
				src: url("./TrajanPro-Regular.ttf");
			}
			
			body {
				background-color: rgb(200, 200, 200);
				color: rgb(25, 25, 25);
				text-align: center;
				font-family: "Trajan Pro", serif;
				font-size: 4.5vmax;
				font-weight: bold;
				padding-top: 5vmax;
			}
			
			td {
				padding-left: 15px;
				text-align: center;
			}
			
			form {
				font-size: 1vmax;
			}
			
			form span {
				font-size: 2vmax;
				
				padding-left: 64px;
				padding-right: 64px;
				border-bottom: 2px solid;
			}
			
			form img {
				vertical-align: middle;
				height: 1.8vmax;
			}
			
			form table {
				margin: 32px auto;
			}
			
			#time {
				font-size: 7vmax;
				font-family: monospace;
			}
		</style>
	</head>
	<body>
		<p>Player Title Card Generator</p>
		
		<form>
			<span>Details</span>
			
			<table>
				<tr>
					<td><img id="govt"/></td>
					<td><label for="name">Name</label></td>
					<td><input type="text" id="name" placeholder="Your Name" maxlength="32" size="36"/></td>
				</tr>
				<tr>
					<td colspan="3"><br/></td>
				</tr>
				<tr>
					<td><img id="admimg" src="./img/powers/adm.png"/></td>
					<td><label for="adm">Administrative Skill</label></td>
					<td><input type="number" id="adm" maxlength="1" size="2" min="0" value="3" max="6"/></td>
				</tr>
				<tr>
					<td><img id="dipimg" src="./img/powers/dip.png"/></td>
					<td><label for="dip">Diplomatic Skill</label></td>
					<td><input type="number" id="dip" maxlength="1" size="2" min="0" value="3" max="6"/></td>
				</tr>
				<tr>
					<td><img id="milimg" src="./img/powers/mil.png"/></td>
					<td><label for="mil">Military Skill</label></td>
					<td><input type="number" id="mil" maxlength="1" size="2" min="0" value="3" max="6"/></td>
				</tr>
				<tr>
					<td colspan="3"><br/></td>
				</tr>
				<tr>
					<td><img id="personality1img"/></td>
					<td><label for="personality1">Personality 1</label></td>
					<td><select id="personality1" /></td>
				</tr>
				<tr>
					<td><img id="personality2img"/></td>
					<td><label for="personality2">Personality 2</label></td>
					<td><select id="personality2" /></td>
				</tr>
				<tr>
					<td><img id="personality3img"/></td>
					<td><label for="personality3">Personality 3</label></td>
					<td><select id="personality3" /></td>
				</tr>
			</table>
		</form>
		
		<canvas width="539" height="674" id="canvas">
			<p>Get a modern Browser ffs.</p>
		</canvas>
		
		<p style="font-size: 2vmax;"><a href="https://twitch.tv/Banane9TV">Check our stream!</a></p>
		
		<!-- Data Stuff -->
		<script>
			var govts = [ "monarchy", "republic", "tribal", "nomad", "theocracy" ];
			
			var personalities = [
				[ "none", "None" ],
				[ "architectural_visionary", "Architectural Visionary" ],
				[ "babbling_buffoon", "Babbling Buffoon" ],
				[ "benevolent", "Benevolent" ],
				[ "bold_fighter", "Bold Fighter" ],
				[ "calm", "Calm" ],
				[ "careful", "Careful" ],
				[ "charismatic_negotiator", "Charismatic Negotiator" ],
				[ "conqueror", "Conqueror" ],
				[ "craven", "Craven" ],
				[ "embezzler", "Embezzler" ],
				[ "entrepeneur", "Entrepeneur" ],
				[ "fierce_negotiator", "Fierce Negotiator" ],
				[ "free_thinker", "Free Thinker" ],
				[ "greedy", "Greedy" ],
				[ "incorruptible", "Incorruptible" ],
				[ "indulgent", "Indulgent" ],
				[ "industrious", "Industrious" ],
				[ "inspiring_leader", "Inspiring Leader" ],
				[ "intricate_webweaver", "Intricate Webweaver" ],
				[ "just", "Just" ],
				[ "kind_hearted", "Kind Hearted" ],
				[ "lawgiver", "Lawgiver" ],
				[ "loose_lips", "Loose Lips" ],
				[ "malevolent", "Malevolent" ],
				[ "martial_educator", "Martial Educator" ],
				[ "midas_touched", "Midas Touched" ],
				[ "naive_enthusiast", "Naive Enthusiast" ],
				[ "navigator", "Navigator" ],
				[ "obsessive_perfectionist", "Obsessive Perfectionist" ],
				[ "pious", "Pious" ],
				[ "righteous", "Righteous" ],
				[ "scholar", "Scholar" ],
				[ "secretive", "Secretive" ],
				[ "silver_tongue", "Silver Tongue" ],
				[ "sinner", "Sinner" ],
				[ "strict", "Strict" ],
				[ "tactical_genius", "Tactical Genius" ],
				[ "tolerant", "Tolerant" ],
				[ "well_connected", "Well Connected" ],
				[ "zealot", "Zealot" ]
			];
			
			var personalitiesImg = [ ];
			for (var p = 0; p < personalities.length; ++p) {
				var img = new Image();
				img.src = "./img/personalities/" + personalities[p][0] + ".png";
				personalitiesImg[personalitiesImg.length] = img;
			}
			
			var form = {
				name: function() { return document.getElementById("name").value; },
				
				adm: function() { return document.getElementById("adm").value; },
				dip: function() { return document.getElementById("dip").value; },
				mil: function() { return document.getElementById("mil").value; },
				
				personality1: function() { return personalitiesImg[document.getElementById("personality1").selectedIndex]; },
				personality2: function() { return personalitiesImg[document.getElementById("personality2").selectedIndex]; },
				personality3: function() { return personalitiesImg[document.getElementById("personality3").selectedIndex]; },
			};
			
			var powers = {
				adm: document.getElementById("admimg"),
				dip: document.getElementById("dipimg"),
				mil: document.getElementById("milimg")
			};
		</script>
		
		<!-- Functionality -->
		<script>
			document.getElementById("govt").src = "./img/govts/" + govts[Math.floor(Math.random() * govts.length)] + ".png";
			
			// Sizes/Coordinates given as x, y / width, height
			var layout = { };
			layout.fullSize = [ 539, 674 ];
			
			layout.innerSize = [ 458, 481 ];
			layout.innerOffset = [ 38, 139 ];
			
			layout.name = [ 265, 122 ];
			
			layout.adm = [ layout.innerOffset[0] + 67, layout.innerOffset[1] + 32 ];
			layout.dip = [ layout.adm[0] + 64 + 66, layout.adm[1] ];
			layout.mil = [ layout.dip[0] + 64 + 66, layout.dip[1] ];
			
			layout.admText = [ layout.adm[0] + 48, layout.adm[1] + 25 ];
			layout.dipText = [ layout.dip[0] + 48, layout.dip[1] + 25 ];
			layout.milText = [ layout.mil[0] + 48, layout.mil[1] + 25 ];
			
			layout.divider1start = [ layout.innerOffset[0] + 48 + 1.5, layout.adm[1] + 32 + 32 + 1.5 ];
			layout.divider1end = [ layout.innerOffset[0] + layout.innerSize[0] - 48 - 1.5, layout.divider1start[1] ];
			
			var updateCanvas = function() {
				context.putImageData(base, 0, 0);
				
				context.fillText(form.name(), layout.name[0], layout.name[1]);
				
				context.fillText(form.adm(), layout.admText[0], layout.admText[1]);
				context.fillText(form.dip(), layout.dipText[0], layout.dipText[1]);
				context.fillText(form.mil(), layout.milText[0], layout.milText[1]);
				
				context.drawImage(form.personality1(), 105, 294);
				context.drawImage(form.personality2(), 235, 294);
				context.drawImage(form.personality3(), 365, 294);
			};
			
			for (var i = 1; i <= 3; ++i)
			{
				var select = document.getElementById("personality" + i);
				select.personalityImg = document.getElementById("personality" + i + "img");
				select.onchange = function() {
					this.personalityImg.src = personalitiesImg[this.selectedIndex].src;
					updateCanvas();
				}
				
				for (var p = 0; p < personalities.length; ++p) {
					var option = document.createElement("option");
					option.text = personalities[p][1];
					
					select.add(option);
				}
				
				select.personalityImg.src = personalitiesImg[select.selectedIndex].src;
			}
			
			document.getElementById("name").onchange = updateCanvas;
			document.getElementById("adm").onchange = updateCanvas;
			document.getElementById("dip").onchange = updateCanvas;
			document.getElementById("mil").onchange = updateCanvas;
			
			context = document.getElementById("canvas").getContext("2d");
			context.font = "24px Trajan Pro";
			context.strokeStyle = "#BD864A";
			context.fillStyle = "#BD864A";
			context.textAlign = "center";
			context.lineWidth = 1.5;
			
			base = context.createImageData(1, 1);
			
			var bg = new Image();
			bg.onload = function() {
				context.drawImage(this, 0, 0);
				
				context.drawImage(powers.adm, layout.adm[0], layout.adm[1]);
				context.drawImage(powers.dip, layout.dip[0], layout.dip[1]);
				context.drawImage(powers.mil, layout.mil[0], layout.mil[1]);
				
				context.beginPath();
				context.moveTo(layout.divider1start[0], layout.divider1start[1]);
				context.lineTo(layout.divider1end[0], layout.divider1end[1]);
				context.stroke();
				
				base = context.getImageData(0, 0, 539, 674);
			
				updateCanvas();
			}
			bg.src = "./img/background.png";
		</script>
	</body>
</html>